<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="phylotaR">
<title>phylotaR Tutorial • phylotaR</title>
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="/apple-touch-icon.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://docs.ropensci.org/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="phylotaR Tutorial">
<meta property="og:description" content="phylotaR">
<meta property="og:image" content="https://docs.ropensci.org/phylotaR/logo.png">
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Matomo --><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.css">
<script src="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.js" data-cfasync="false"></script><script src="https://ropensci.org/scripts/matomo.js"></script><noscript><p><img src="https://ropensci.matomo.cloud/matomo.php?idsite=1&amp;rec=1" style="border:0;" alt=""></p></noscript>
<!-- End Matomo Code -->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    <a href="https://ropensci.org" class="external-link"><img src="https://ropensci.org/img/icon_short_white.svg" id="hexlogo" alt="rOpenSci"></a>
    <a class="navbar-brand me-2" href="../index.html">phylotaR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.3.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../articles/phylotaR.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ropensci/phylotaR">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>phylotaR Tutorial</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ropensci/phylotaR/blob/HEAD/vignettes/phylotaR.Rmd" class="external-link"><code>vignettes/phylotaR.Rmd</code></a></small>
      <div class="d-none name"><code>phylotaR.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The first step to running a phylogenetic analysis is the identification of overlapping sequences. Often orthology is determined by pairing sequences whose gene names match (e.g. COI sequences with COI sequences, rbcl sequences with rbcl sequences). Problems can arise however if gene names differ between authors, if different gene sections are represented or if sequences are mislabelled. These issues can be especially problematic for large-scale analyses where individual errors cannot be detected.</p>
<p><a href="https://pubmed.ncbi.nlm.nih.gov/18570030/" class="external-link">PhyLoTa</a> is a pipeline that uses an alignment search tool to identify orthologous sequences without the need for gene name matching. For a given parental taxonomic group, the pipeline will search through available sequences hosted on GenBank and identify orthologous sequence clusters. A user is then able to survey the identified clusters and select the ones which best suit their phylogenetic analysis needs, e.g. by selecting the clusters that maximise the number of taxonomic groups.</p>
<p>This R pacakge, <code>phylotaR</code>, is an R implementation of this pipeline. In this vignette we will demonstrate how to run PhyLoTa using a small taxonomic group. The pipeline is composed of four automated stages (taxise, download, cluster, cluster2) and a final user-performed stage of cluster selection.</p>
</div>
<div class="section level2">
<h2 id="installing-ncbi-blast-tools">Installing NCBI BLAST+ Tools<a class="anchor" aria-label="anchor" href="#installing-ncbi-blast-tools"></a>
</h2>
<p>The PhyLoTa pipeline uses BLAST to identify orthologous sequence clusters. In order to run phylotaR, a local copy of the BLAST software must be installed on your computer. <strong>Installing the phylotaR package does not install BLAST, it must be installed separately</strong>. To install BLAST+, please see the NCBI website’s <a href="https://www.ncbi.nlm.nih.gov/books/NBK279671/" class="external-link">installation instructions</a>.</p>
</div>
<div class="section level2">
<h2 id="pipeline">Pipeline<a class="anchor" aria-label="anchor" href="#pipeline"></a>
</h2>
<div class="section level3">
<h3 id="setup">Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h3>
<p>For demonstration purposes we will run the pipeline on a small taxonomic group. Because they are charismatic and relatively well-studied, we will select the Night Monkey genus, <a href="https://www.ncbi.nlm.nih.gov/Taxonomy/Browser/wwwtax.cgi?mode=Info&amp;id=9504" class="external-link">Aotus</a>. Now that we have decided on a taxonomic group we need to find out its unique taxonomic ID. This can be looked up by navigating to the <a href="https://www.ncbi.nlm.nih.gov/taxonomy" class="external-link">NCBI taxonomy webpage</a> and searching ‘Aotus’. Doing this, we can see that Aotus ID is <strong>9504</strong>. We will need this number for specifying the parameters in our pipeline. (Notice, that there is also a plant genus called Aotus.)</p>
<p>To begin a run, we will need to create a new folder that will contain all the output files generated by the <code>phylotaR</code> pipeline. Since we are running the analysis on the Aotus genus, let’s call the folder <code>aotus/</code>. Now we have our working directory folder created, we can now open R and run the following code.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/phylotaR/">phylotaR</a></span><span class="op">)</span></span>
<span><span class="va">wd</span> <span class="op">&lt;-</span> <span class="st">'[YOUR PATH TO AOTUS FOLDER]'</span></span>
<span><span class="va">ncbi_dr</span> <span class="op">&lt;-</span> <span class="st">'[YOUR PATH TO NCBI BLAST TOOLS]'</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">txid</span> <span class="op">&lt;-</span> <span class="fl">9504</span></span>
<span><span class="fu"><a href="../reference/setup.html">setup</a></span><span class="op">(</span>wd <span class="op">=</span> <span class="va">wd</span>, txid <span class="op">=</span> <span class="va">txid</span>, ncbi_dr <span class="op">=</span> <span class="va">ncbi_dr</span>, v <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## -----------------------------------------------------</span></span>
<span><span class="co">## phylotaR: Implementation of PhyLoTa in R [v1.2.0.999]</span></span>
<span><span class="co">## -----------------------------------------------------</span></span>
<span><span class="co">## Checking for valid NCBI BLAST+ Tools ...</span></span>
<span><span class="co">## Found: [/workspaces/blast/bin/makeblastdb]</span></span>
<span><span class="co">## Found: [/workspaces/blast/bin/blastn]</span></span>
<span><span class="co">## . . Running makeblastdb</span></span>
<span><span class="co">## Setting up pipeline with the following parameters:</span></span>
<span><span class="co">## . blstn          [/workspaces/blast/bin/blastn]</span></span>
<span><span class="co">## . btchsz         [100]</span></span>
<span><span class="co">## . date           [2022-07-12]</span></span>
<span><span class="co">## . db_only        [FALSE]</span></span>
<span><span class="co">## . mdlthrs        [3000]</span></span>
<span><span class="co">## . mkblstdb       [/workspaces/blast/bin/makeblastdb]</span></span>
<span><span class="co">## . mncvrg         [51]</span></span>
<span><span class="co">## . mnsql          [250]</span></span>
<span><span class="co">## . multiple_ids   [FALSE]</span></span>
<span><span class="co">## . mxevl          [1e-10]</span></span>
<span><span class="co">## . mxnds          [1e+05]</span></span>
<span><span class="co">## . mxrtry         [100]</span></span>
<span><span class="co">## . mxsql          [2000]</span></span>
<span><span class="co">## . mxsqs          [50000]</span></span>
<span><span class="co">## . ncps           [1]</span></span>
<span><span class="co">## . outfmt         [6 qseqid sseqid pident length evalue qcovs qcovhsp]</span></span>
<span><span class="co">## . outsider       [FALSE]</span></span>
<span><span class="co">## . srch_trm       [NOT predicted[TI] NOT "whole genome shotgun"[TI] NOT unverified[TI] NOT "synthetic construct"[Organism] NOT refseq[filter] NOT TSA[Keyword]]</span></span>
<span><span class="co">## . txid           [9504]</span></span>
<span><span class="co">## . v              [TRUE]</span></span>
<span><span class="co">## . wd             [/tmp/RtmpDeuk8B]</span></span>
<span><span class="co">## . wt_tms         [1, 3, 6 ...]</span></span>
<span><span class="co">## -----------------------------------------------------</span></span></code></pre>
<p>The above imports the <code>phylotaR</code> package and initiates a cache that will contain the pipeline parameters. For this tutorial we will keep the parameters as their default. See the function <code><a href="../reference/parameters.html">parameters()</a></code> for a complete list and description of all the parameters and their default values. For more detailed information on the parameters please see the publication, <a href="https://doi.org/10.3390/life8020020" class="external-link">phylotaR: An Automated Pipeline for Retrieving Orthologous DNA Sequences from GenBank in R</a>. <code>wd</code> must be a file path to the folder we called <code>aotus/</code>. <code>ncbi_dr</code> must be a file path to the folder containing all the NCBI BLAST+ tools – see above ‘Installing NCBI BLAST+ Tools’. Depending on your system and how you installed the tools, they may be in your system path in which case you can simply supply ‘.’ to the <code>ncbi_dr</code> argument. On my computer I provide the path to the where the <code>blastn</code> executable is located, e.g. <code>/usr/local/ncbi/blast/bin/</code>. Running <code><a href="../reference/setup.html">setup()</a></code> will verify whether the BLAST tools are installed correctly.</p>
</div>
<div class="section level3">
<h3 id="running">Running<a class="anchor" aria-label="anchor" href="#running"></a>
</h3>
<p>After <code><a href="../reference/setup.html">setup()</a></code> has been run we can run the pipeline with the following command.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/run.html">run</a></span><span class="op">(</span>wd <span class="op">=</span> <span class="va">wd</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## ---------------------------------------------------</span></span>
<span><span class="co">## Running pipeline on [unix] at [2022-07-12 13:55:01]</span></span>
<span><span class="co">## ---------------------------------------------------</span></span>
<span><span class="co">## Running stages: taxise, download, cluster, cluster2</span></span>
<span><span class="co">## --------------------------------------------</span></span>
<span><span class="co">## Starting stage TAXISE: [2022-07-12 13:55:01]</span></span>
<span><span class="co">## --------------------------------------------</span></span>
<span><span class="co">## Searching taxonomic IDs ...</span></span>
<span><span class="co">## Downloading taxonomic records ...</span></span>
<span><span class="co">## . [1-22]</span></span>
<span><span class="co">## Generating taxonomic dictionary ...</span></span>
<span><span class="co">## ---------------------------------------------</span></span>
<span><span class="co">## Completed stage TAXISE: [2022-07-12 13:55:06]</span></span>
<span><span class="co">## ---------------------------------------------</span></span>
<span><span class="co">## ----------------------------------------------</span></span>
<span><span class="co">## Starting stage DOWNLOAD: [2022-07-12 13:55:06]</span></span>
<span><span class="co">## ----------------------------------------------</span></span>
<span><span class="co">## Identifying suitable clades ...</span></span>
<span><span class="co">## Identified [1] suitable clades.</span></span>
<span><span class="co">## Downloading hierarchically ...</span></span>
<span><span class="co">## Working on parent [id 9504]: [1/1] ...</span></span>
<span><span class="co">## . + direct ...</span></span>
<span><span class="co">## . + by child ...</span></span>
<span><span class="co">## . . Working on child [id 2688256]</span></span>
<span><span class="co">## . . + whole subtree ...</span></span>
<span><span class="co">## . . . Downloading [34 sqs] ...</span></span>
<span><span class="co">## . . . . [1-34]</span></span>
<span><span class="co">## . . . Working on child [id 1263727]</span></span>
<span><span class="co">## . . . + whole subtree ...</span></span>
<span><span class="co">## . . . . Downloading [3 sqs] ...</span></span>
<span><span class="co">## . . . . . [1-3]</span></span>
<span><span class="co">## . . . . Working on child [id 361674]</span></span>
<span><span class="co">## . . . . + whole subtree ...</span></span>
<span><span class="co">## . . . . . Downloading [1 sqs] ...</span></span>
<span><span class="co">## . . . . . . [1-1]</span></span>
<span><span class="co">## . . . . . Working on child [id 292213]</span></span>
<span><span class="co">## . . . . . + whole subtree ...</span></span>
<span><span class="co">## . . . . . . Downloading [100 sqs] ...</span></span>
<span><span class="co">## . . . . . . . [1-100]</span></span>
<span><span class="co">## . . . . . . Working on child [id 57176]</span></span>
<span><span class="co">## . . . . . . + whole subtree ...</span></span>
<span><span class="co">## . . . . . . . Downloading [200 sqs] ...</span></span>
<span><span class="co">## . . . . . . . . [1-100]</span></span>
<span><span class="co">## . . . . . . . . [101-200]</span></span>
<span><span class="co">## . . . . . . . Working on child [id 57175]</span></span>
<span><span class="co">## . . . . . . . + whole subtree ...</span></span>
<span><span class="co">## . . . . . . . . Downloading [100 sqs] ...</span></span>
<span><span class="co">## . . . . . . . . . [1-100]</span></span>
<span><span class="co">## . . . . . . . . Working on child [id 43147]</span></span>
<span><span class="co">## . . . . . . . . + whole subtree ...</span></span>
<span><span class="co">## . . . . . . . . . Downloading [900 sqs] ...</span></span>
<span><span class="co">## . . . . . . . . . . [1-100]</span></span>
<span><span class="co">## . . . . . . . . . . [101-200]</span></span>
<span><span class="co">## . . . . . . . . . . [201-300]</span></span>
<span><span class="co">## . . . . . . . . . . [301-400]</span></span>
<span><span class="co">## . . . . . . . . . . [401-500]</span></span>
<span><span class="co">## . . . . . . . . . . [501-600]</span></span>
<span><span class="co">## . . . . . . . . . . [601-700]</span></span>
<span><span class="co">## . . . . . . . . . . [701-800]</span></span>
<span><span class="co">## . . . . . . . . . . [801-900]</span></span>
<span><span class="co">## . . . . . . . . . Working on child [id 37293]</span></span>
<span><span class="co">## . . . . . . . . . + whole subtree ...</span></span>
<span><span class="co">## . . . . . . . . . . Downloading [600 sqs] ...</span></span>
<span><span class="co">## . . . . . . . . . . . [1-100]</span></span>
<span><span class="co">## . . . . . . . . . . . [101-200]</span></span>
<span><span class="co">## . . . . . . . . . . . [201-300]</span></span>
<span><span class="co">## . . . . . . . . . . . [301-400]</span></span>
<span><span class="co">## . . . . . . . . . . . [401-500]</span></span>
<span><span class="co">## . . . . . . . . . . . [501-600]</span></span>
<span><span class="co">## . . . . . . . . . . Working on child [id 30591]</span></span>
<span><span class="co">## . . . . . . . . . . + whole subtree ...</span></span>
<span><span class="co">## . . . . . . . . . . . Downloading [1000 sqs] ...</span></span>
<span><span class="co">## . . . . . . . . . . . . [1-100]</span></span>
<span><span class="co">## . . . . . . . . . . . . [101-200]</span></span>
<span><span class="co">## . . . . . . . . . . . . [201-300]</span></span>
<span><span class="co">## . . . . . . . . . . . . [301-400]</span></span>
<span><span class="co">## . . . . . . . . . . . . [401-500]</span></span>
<span><span class="co">## . . . . . . . . . . . . [501-600]</span></span>
<span><span class="co">## . . . . . . . . . . . . [601-700]</span></span>
<span><span class="co">## . . . . . . . . . . . . [701-800]</span></span>
<span><span class="co">## . . . . . . . . . . . . [801-900]</span></span>
<span><span class="co">## . . . . . . . . . . . . [901-1000]</span></span>
<span><span class="co">## . . . . . . . . . . . Working on child [id 9505]</span></span>
<span><span class="co">## . . . . . . . . . . . + whole subtree ...</span></span>
<span><span class="co">## . . . . . . . . . . . . Downloading [300 sqs] ...</span></span>
<span><span class="co">## . . . . . . . . . . . . . [1-100]</span></span>
<span><span class="co">## . . . . . . . . . . . . . [101-200]</span></span>
<span><span class="co">## . . . . . . . . . . . . . [201-300]</span></span>
<span><span class="co">## Successfully retrieved [3238 sqs] in total.</span></span>
<span><span class="co">## -----------------------------------------------</span></span>
<span><span class="co">## Completed stage DOWNLOAD: [2022-07-12 13:57:42]</span></span>
<span><span class="co">## -----------------------------------------------</span></span>
<span><span class="co">## ---------------------------------------------</span></span>
<span><span class="co">## Starting stage CLUSTER: [2022-07-12 13:57:42]</span></span>
<span><span class="co">## ---------------------------------------------</span></span>
<span><span class="co">## Working from [id 9504] down hierarchy</span></span>
<span><span class="co">## . + direct [id 9504 (genus)]</span></span>
<span><span class="co">## . + subtree [id 9504 (genus)]</span></span>
<span><span class="co">## . . BLASTing [3238 sqs] ....</span></span>
<span><span class="co">## . . Running makeblastdb</span></span>
<span><span class="co">## . . Running blastn</span></span>
<span><span class="co">## . . Removed [85435/180447] hits due to insufficient coverage</span></span>
<span><span class="co">## . . Identified [797] clusters</span></span>
<span><span class="co">## . + parent [id 9504]</span></span>
<span><span class="co">## . . + direct [id 2688256 (no rank)]</span></span>
<span><span class="co">## . . + subtree [id 2688256 (no rank)]</span></span>
<span><span class="co">## . . . BLASTing [34 sqs] ....</span></span>
<span><span class="co">## . . . Removed [0/417] hits due to insufficient coverage</span></span>
<span><span class="co">## . . . Identified [15] clusters</span></span>
<span><span class="co">## . . + parent [id 2688256]</span></span>
<span><span class="co">## . . . + subtree [id 1230482 (species)]</span></span>
<span><span class="co">## . . + parent [id 2688256]</span></span>
<span><span class="co">## . . . + subtree [id 1090913 (species)]</span></span>
<span><span class="co">## . . + parent [id 2688256]</span></span>
<span><span class="co">## . . . + subtree [id 1002694 (species)]</span></span>
<span><span class="co">## . . + parent [id 2688256]</span></span>
<span><span class="co">## . . . + subtree [id 940829 (species)]</span></span>
<span><span class="co">## . . + parent [id 2688256]</span></span>
<span><span class="co">## . . . + subtree [id 413234 (species)]</span></span>
<span><span class="co">## . . + parent [id 2688256]</span></span>
<span><span class="co">## . . . + subtree [id 261316 (species)]</span></span>
<span><span class="co">## . . + parent [id 2688256]</span></span>
<span><span class="co">## . . . + subtree [id 231953 (species)]</span></span>
<span><span class="co">## . . + parent [id 2688256]</span></span>
<span><span class="co">## . . . + subtree [id 222417 (species)]</span></span>
<span><span class="co">## . + parent [id 9504]</span></span>
<span><span class="co">## . . + subtree [id 1263727 (species)]</span></span>
<span><span class="co">## . + parent [id 9504]</span></span>
<span><span class="co">## . . + subtree [id 361674 (species)]</span></span>
<span><span class="co">## . + parent [id 9504]</span></span>
<span><span class="co">## . . + subtree [id 292213 (species)]</span></span>
<span><span class="co">## . + parent [id 9504]</span></span>
<span><span class="co">## . . + subtree [id 57176 (species)]</span></span>
<span><span class="co">## . + parent [id 9504]</span></span>
<span><span class="co">## . . + subtree [id 57175 (species)]</span></span>
<span><span class="co">## . + parent [id 9504]</span></span>
<span><span class="co">## . . + subtree [id 43147 (species)]</span></span>
<span><span class="co">## . + parent [id 9504]</span></span>
<span><span class="co">## . . + subtree [id 37293 (species)]</span></span>
<span><span class="co">## . + parent [id 9504]</span></span>
<span><span class="co">## . . + direct [id 30591 (species)]</span></span>
<span><span class="co">## . . . BLASTing [565 sqs] ....</span></span>
<span><span class="co">## . . . Removed [36184/51565] hits due to insufficient coverage</span></span>
<span><span class="co">## . . . Identified [266] clusters</span></span>
<span><span class="co">## . . + subtree [id 30591 (species)]</span></span>
<span><span class="co">## . . . BLASTing [435 sqs] ....</span></span>
<span><span class="co">## . . . Removed [911/7414] hits due to insufficient coverage</span></span>
<span><span class="co">## . . . Identified [71] clusters</span></span>
<span><span class="co">## . . + parent [id 30591]</span></span>
<span><span class="co">## . . . + subtree [id 867331 (subspecies)]</span></span>
<span><span class="co">## . . + parent [id 30591]</span></span>
<span><span class="co">## . . . + subtree [id 280755 (subspecies)]</span></span>
<span><span class="co">## . . + parent [id 30591]</span></span>
<span><span class="co">## . . . + subtree [id 120088 (subspecies)]</span></span>
<span><span class="co">## . + parent [id 9504]</span></span>
<span><span class="co">## . . + subtree [id 9505 (species)]</span></span>
<span><span class="co">## [1/1]</span></span>
<span><span class="co">## ----------------------------------------------</span></span>
<span><span class="co">## Completed stage CLUSTER: [2022-07-12 13:57:58]</span></span>
<span><span class="co">## ----------------------------------------------</span></span>
<span><span class="co">## -----------------------------------------------</span></span>
<span><span class="co">## Starting stage CLUSTER^2: [2022-07-12 13:57:58]</span></span>
<span><span class="co">## -----------------------------------------------</span></span>
<span><span class="co">## Loading clusters ...</span></span>
<span><span class="co">## Done. Only one cluster set -- skipping cluster^2</span></span>
<span><span class="co">## Dropping all clusters of &lt; 3 sqs ...</span></span>
<span><span class="co">## Renumbering clusters ...</span></span>
<span><span class="co">## Saving ...</span></span>
<span><span class="co">## ------------------------------------------------</span></span>
<span><span class="co">## Completed stage CLUSTER^2: [2022-07-12 13:57:59]</span></span>
<span><span class="co">## ------------------------------------------------</span></span>
<span><span class="co">## -------------------------------------------</span></span>
<span><span class="co">## Completed pipeline at [2022-07-12 13:57:59]</span></span>
<span><span class="co">## -------------------------------------------</span></span></code></pre>
<p>This will run all the automated stages of the pipeline: taxise, download, cluster and cluster2. The first of these stages looks up all the taxonomic information available on the descendants of the parent ID provided, <code>txid</code>. The second downloads representative sequences for all identified descendants. No additional arguments are required other than <code>wd</code> which specifies the working directory that contains the cache and all parameters as set up by <code><a href="../reference/setup.html">setup()</a></code>. In this folder you will also find a <code>log.txt</code> that reports detailed information on the progression of the pipeline as well as all the output files generated by each stage. Additionally, you will see session info and a blast version text files. These files, along with the log, can help debugging if any errors occur. The whole pipeline can complete in around 2 minutes for Aotus using default parameters. Aotus, however, is a genus of only 13 taxa, larger clades will take much longer particularly during the download stage.</p>
</div>
<div class="section level3">
<h3 id="restarting">Restarting<a class="anchor" aria-label="anchor" href="#restarting"></a>
</h3>
<p>The pipeline can be halted and restarted. The cache records all downloaded and generated data by the pipeline. If there is a system crash or the user wishes to halt the program, the pipeline can be restarted from the same point it stopped with the function <code><a href="../reference/restart.html">restart()</a></code>. Additionally, due to the potential random nature of the pipeline, a user may wish to re-run the pipeline from certain stages. This can be achived by first using <code><a href="../reference/reset.html">reset()</a></code> followed by <code><a href="../reference/restart.html">restart()</a></code>. For example, in the code below a completed pipeline is reset to ‘cluster’ and then restarted. After running these commands, the pipeline will run as if it has only just completed the download stage. Note, all resets and restarts are recorded in the log.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/reset.html">reset</a></span><span class="op">(</span>wd <span class="op">=</span> <span class="va">wd</span>, stage <span class="op">=</span> <span class="st">'cluster'</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/restart.html">restart</a></span><span class="op">(</span>wd <span class="op">=</span> <span class="va">wd</span><span class="op">)</span></span></code></pre></div>
<div class="section level4">
<h4 id="changing-parameters">Changing parameters<a class="anchor" aria-label="anchor" href="#changing-parameters"></a>
</h4>
<p>Paramaters can always be set by a user at the initiation of a folder with the <code><a href="../reference/setup.html">setup()</a></code> function. To change the parameter values after a folder has already been set up, a user can use <code><a href="../reference/parameters_reset.html">parameters_reset()</a></code>. For example, if the download stage is taking particularly long, the <code>btchsz</code> could be increased. This would raise the number of sequences downloaded per request. (Note, too high a <code>btchsz</code> may cause your NCBI Entrez access being limited.)</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># use ctrl+c or Esc to halt R</span></span>
<span><span class="co"># increase the btchsz from the default to 300</span></span>
<span><span class="fu"><a href="../reference/parameters_reset.html">parameters_reset</a></span><span class="op">(</span>wd <span class="op">=</span> <span class="va">wd</span>, parameters <span class="op">=</span> <span class="st">'btchz'</span>, values <span class="op">=</span> <span class="fl">300</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/restart.html">restart</a></span><span class="op">(</span>wd <span class="op">=</span> <span class="va">wd</span><span class="op">)</span></span>
<span><span class="co"># ^ restart from whatever point it was halted</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="cluster-selection">Cluster selection<a class="anchor" aria-label="anchor" href="#cluster-selection"></a>
</h3>
<p>After a pipeline has completed, the identified clusters can be interrogated. We can generate a phylota object using <code><a href="../reference/read_phylota.html">read_phylota()</a></code> but in the code below we will load a pre-existing phylota object from the package data. The phylota object contains cluster, sequence and taxonomic information on all the clusters. It has 6 data slots: cids, sids, txids, txdct, sqs, clstrs, prnt_id and prnt_nm. Each of these slots can be accessed with <code>@</code>, see ?`Phylota-class` for more information. The <code>phylotaR</code> package has a range of functions for probing clusters in a phylota object. For example, if we want to know how many different taxonomic groups are represented by each cluster we can use <code><a href="../reference/get_ntaxa.html">get_ntaxa()</a></code>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/phylotaR/">phylotaR</a></span><span class="op">)</span></span>
<span><span class="co"># pre-load already run aotus from package data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">'aotus'</span><span class="op">)</span></span>
<span><span class="va">all_clusters</span> <span class="op">&lt;-</span> <span class="va">aotus</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">all_clusters</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "Phylota Table (Aotus)\n- [193] clusters\n- [1499] sequences\n- [13] source taxa\n"</span></span></code></pre>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># otherwise, run:</span></span>
<span><span class="co"># all_clusters &lt;- read_phylota(wd)</span></span>
<span><span class="va">cids</span> <span class="op">&lt;-</span> <span class="va">all_clusters</span><span class="op">@</span><span class="va">cids</span></span>
<span><span class="va">n_taxa</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_ntaxa.html">get_ntaxa</a></span><span class="op">(</span>phylota <span class="op">=</span> <span class="va">all_clusters</span>, cid <span class="op">=</span> <span class="va">cids</span><span class="op">)</span></span></code></pre></div>
<p>We can then drop all the clusters with fewer than 6 taxa and create a new phylota object using the <code>drop_cls()</code> function. Let’s then take a peak of the now smaller object’s clusters using <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code>.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">keep</span> <span class="op">&lt;-</span> <span class="va">cids</span><span class="op">[</span><span class="va">n_taxa</span> <span class="op">&gt;</span> <span class="fl">6</span><span class="op">]</span></span>
<span><span class="va">selected</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/drop_clstrs.html">drop_clstrs</a></span><span class="op">(</span>phylota <span class="op">=</span> <span class="va">all_clusters</span>, cid <span class="op">=</span> <span class="va">keep</span><span class="op">)</span></span>
<span><span class="va">smmry</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">selected</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">smmry</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   ID    Type                Seed Parent N_taxa N_seqs Med_sql       MAD                      Definition</span></span>
<span><span class="co">## 1  4 subtree            U36844.1   9504      9     41     549 0.8397112 gene (0.1), mitochondrial (0.1)</span></span>
<span><span class="co">## 2  9 subtree          AJ489745.1   9504     10     29    1140 1.0000000   aotus (0.1), cytochrome (0.1)</span></span>
<span><span class="co">## 3 29 subtree AF338374.1/177..829   9504      8     10     653 0.9658499          sry (0.2), aotus (0.1)</span></span>
<span><span class="co">##                        Feature</span></span>
<span><span class="co">## 1                     coii (1)</span></span>
<span><span class="co">## 2 cytb (0.4), cytochrome (0.3)</span></span>
<span><span class="co">## 3                      sry (1)</span></span></code></pre>
<p>This summary provides information on each cluster in the phylota object, such as median sequence length, MAD score (the mean alignment density, values closer to 1 indicate all the sequences are of a similar length), most common words in the sequence descriptions and feature names. Let’s select the second ID in this table for further investigation. We can extract its cluster and sequences records in the following way.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cid</span> <span class="op">&lt;-</span> <span class="va">smmry</span><span class="op">[</span><span class="fl">2</span>, <span class="st">'ID'</span><span class="op">]</span></span>
<span><span class="co"># get the cluster record</span></span>
<span><span class="va">cluster_record</span> <span class="op">&lt;-</span> <span class="va">selected</span><span class="op">@</span><span class="va">clstrs</span><span class="op">[[</span><span class="va">cid</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co"># use the seq. IDs to get the sequence records</span></span>
<span><span class="va">seq_records</span> <span class="op">&lt;-</span> <span class="va">selected</span><span class="op">@</span><span class="va">sqs</span><span class="op">[</span><span class="va">cluster_record</span><span class="op">@</span><span class="va">sids</span><span class="op">]</span></span>
<span><span class="co"># extract a single record</span></span>
<span><span class="va">seq_record</span> <span class="op">&lt;-</span> <span class="va">seq_records</span><span class="op">[[</span><span class="va">seq_records</span><span class="op">@</span><span class="va">ids</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">seq_record</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## SeqRec [ID: AJ489745.1]</span></span></code></pre>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># get the sequence</span></span>
<span><span class="va">seq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rawConversion.html" class="external-link">rawToChar</a></span><span class="op">(</span><span class="va">seq_record</span><span class="op">@</span><span class="va">sq</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/substr.html" class="external-link">substr</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">seq</span>, start <span class="op">=</span> <span class="fl">1</span>, stop <span class="op">=</span> <span class="fl">80</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "atgacttctccccgcaaaacacacccactaacaaagatcattaacgaatcattcattgatctacccacaccacccaacat"</span></span></code></pre>
<p>We could extract and write out each of the sequences for a cluster in the above manner. Handily, however, <code>phylotaR</code> comes with some tools to make outputting sequences easier. First because there are multiple sequences per taxon, we need to select a single representative sequence. We can do this with the <code><a href="../reference/drop_by_rank.html">drop_by_rank()</a></code> function. With this function we choose a taxonomic rank at which we would like our sequences to be represented. The function then chooses the ‘best’ sequence representing each taxon for that rank using a range of criteria. With this new phylota object, we can then extract the scientific names and write out the sequences.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># choose best sequence per species</span></span>
<span><span class="va">reduced</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/drop_by_rank.html">drop_by_rank</a></span><span class="op">(</span>phylota <span class="op">=</span> <span class="va">selected</span>, rnk <span class="op">=</span> <span class="st">'species'</span>, n <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co"># get txids at the species level for each sequence</span></span>
<span><span class="va">txids</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_txids.html">get_txids</a></span><span class="op">(</span>phylota <span class="op">=</span> <span class="va">reduced</span>, cid <span class="op">=</span> <span class="va">cid</span>, rnk <span class="op">=</span> <span class="st">'species'</span><span class="op">)</span></span>
<span><span class="co"># look up name for txids</span></span>
<span><span class="va">scientific_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_tx_slot.html">get_tx_slot</a></span><span class="op">(</span>phylota <span class="op">=</span> <span class="va">reduced</span>, txid <span class="op">=</span> <span class="va">txids</span>, slt_nm <span class="op">=</span> <span class="st">'scnm'</span><span class="op">)</span></span>
<span><span class="co"># clean the names</span></span>
<span><span class="va">scientific_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">'\\.'</span>, <span class="st">''</span>, <span class="va">scientific_names</span><span class="op">)</span></span>
<span><span class="va">scientific_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">'\\s+'</span>, <span class="st">'_'</span>, <span class="va">scientific_names</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">scientific_names</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##           AJ489745.1           DQ098865.1           DQ098869.1           DQ098873.1           HQ005497.1           HQ005502.1 </span></span>
<span><span class="co">##    "Aotus_nancymaae"       "Aotus_azarai" "Aotus_griseimembra"  "Aotus_trivirgatus"    "Aotus_nigriceps"   "Aotus_vociferans" </span></span>
<span><span class="co">##           HQ005506.1   KR528418.1/1..1140 </span></span>
<span><span class="co">##    "Aotus_lemurinus"           "Aotus_sp"</span></span></code></pre>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># look up sequence IDs for our chosen cluster</span></span>
<span><span class="va">sids</span> <span class="op">&lt;-</span> <span class="va">reduced</span><span class="op">@</span><span class="va">clstrs</span><span class="op">[[</span><span class="va">cid</span><span class="op">]</span><span class="op">]</span><span class="op">@</span><span class="va">sids</span></span>
<span><span class="co"># write out</span></span>
<span><span class="fu"><a href="../reference/write_sqs.html">write_sqs</a></span><span class="op">(</span>phylota <span class="op">=</span> <span class="va">reduced</span>, sid <span class="op">=</span> <span class="va">sids</span>, sq_nm <span class="op">=</span> <span class="va">scientific_names</span>,</span>
<span>          outfile <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">'cytb.fasta'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># ^ to avoid clutter, we're writing to a temporary folder</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="testing-output">Testing output<a class="anchor" aria-label="anchor" href="#testing-output"></a>
</h3>
<p>We can sanity check our cluster sequences by running a very quick phylogenetic analysis using mafft and raxml. The below code will use the cluster to generate an alignment and a tree through R. In order for the code to run, it requires the installation of mafft and raxml and, additionally, may require tweaking to work on your system.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://ape-package.ird.fr/" class="external-link">ape</a></span><span class="op">)</span></span>
<span><span class="va">cwd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">getwd</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">setwd</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># https://mafft.cbrc.jp/alignment/software/linux.html</span></span>
<span><span class="co"># https://github.com/stamatak/standard-RAxML</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/system.html" class="external-link">system</a></span><span class="op">(</span><span class="st">'mafft --auto cytb.fasta &gt; alignment.fasta'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/system.html" class="external-link">system</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">'raxmlHPC -m GTRGAMMA -f a -N 10 -p 1234 -x 1234 -n aotus -s alignment.fasta'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">tree</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ape/man/read.tree.html" class="external-link">read.tree</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">'RAxML_bestTree.aotus'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tree</span>, no.margin <span class="op">=</span> <span class="cn">TRUE</span>, type <span class="op">=</span> <span class="st">'unrooted'</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="testing-1.png" alt=""><p class="caption">plot of chunk testing</p>
</div>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">setwd</a></span><span class="op">(</span><span class="va">cwd</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><!-- begin footer --><div class="footer">
    <div class="container">
        <div class="row start top-4 bottom-8">
            <div class="col-2"> <img id="footerlogo" src="https://ropensci.org/img/icon_short_white.svg">
</div>
            <div class="col-10">
                <div class="row">
                    <div class="col-md-4 col-xs-6">
                        <a href="https://github.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-github"></div></a>
                        <a href="https://github.com/ropenscilabs" target="_blank" class="external-link"><div class="icon fa fa-flask"></div></a>
                        <a href="https://hachyderm.io/@ropensci" target="_blank" class="external-link"><div class="icon fab fa-mastodon"></div></a>
                        <a href="https://vimeo.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-vimeo"></div></a>
                    </div>
                </div>
                <div class="row top-4">
                    <div class="col-md-2 col-sm-4">
                        <ul>
<h5 class="bottom-2">About</h5>
                            <li><a href="https://ropensci.org/about" class="external-link">About rOpenSci</a></li>
                            <li><a href="https://ropensci.org/software-review" class="external-link">Software Review</a></li>
                            <li><a href="https://ropensci.org/about#team" class="external-link">Our Team</a></li>
                            <li><a href="https://ropensci.org/careers" class="external-link">Jobs</a></li>
                            <li><a href="https://ropensci.org/donate" class="external-link">Donate</a></li>
                            <li><a href="https://ropensci.org/contact" class="external-link">Contact Us</a></li>
                        </ul>
</div>
                    <div class="col-md-3 col-sm-4">
                        <ul>
<h5 class="bottom-2">Community</h5>
                            <li><a href="https://ropensci.org/community/" class="external-link">Our Community</a></li>
                            <li><a href="https://ropensci.org/commcalls/" class="external-link">Community calls</a></li>
                            <li><a href="https://ropensci.org/events/" class="external-link">Events</a></li>
                            <li><a href="https://discuss.ropensci.org/" class="external-link">Join the Discussion</a></li>
                            <li><a href="https://ropensci.org/code-of-conduct" class="external-link">Code of conduct</a></li>
                        </ul>
</div>
                    <div class="col-md-2 col-sm-4">
                        <ul>
<h5 class="bottom-2">Resources</h5>
                            <li><a href="https://ropensci.org/packages/" class="external-link">Packages</a></li>
                            <li><a href="https://ropensci.org/usecases/" class="external-link">Use Cases</a></li>
                            <li><a href="https://ropensci.org/talks-papers/" class="external-link">Talks &amp; Publications</a></li>
                            <li><a href="https://docs.ropensci.org/" class="external-link">Documentation</a></li>
                            <li><a href="https://ropensci.org/news/" class="external-link">Newsletter</a></li>
                            <li><a href="https://ropensci.org/how-to-cite-ropensci/" class="external-link">Cite rOpenSci</a></li>
                        </ul>
</div>
                    <div class="col-md-4 col-xs-12">
                        <h5 class="bottom-2"></h5>

                        <p>rOpenSci is a fiscally sponsored project of <a href="http://numfocus.org" class="external-link">NumFOCUS</a>.</p>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- / end footer -->


    </footer>
</div>

  

  

  </body>
</html>
